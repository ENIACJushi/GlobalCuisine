
## 自定义方块属性

[TOC]

----

### 循环属性

当玩家和方块交互时，循环切换方块的指定属性
1. 给方块 `components` 加上 `"amp:circular_states": {}`
2. 在文件定义属性循环的列表：`GlobalCuisine_BP/scripts/data/BlockCircularStates.js`，如：
  ```
  "amp:phone": { // 方块标识符
    /**
     * simple 是切换类型，目前固定填这个值
     * amp:desktop 是属性名
     * [ 0, 1, 2, 3, 4, 5, 6 ] 是状态的列表，按这个顺序循环设置属性
     */
    "simple": { "amp:desktop": [ 0, 1, 2, 3, 4, 5, 6 ] }
  },
  ```

### 坐位方块

玩家和方块交互时，可以坐上去。设置方法：
1. 给方块 `components` 加上 `"amp:seat": {}`
2. 在文件定义坐位类型和位置： `GlobalCuisine_BP/scripts/data/BlockSeat.js`，如：
  ```
  "amp:stone_stool": { // 方块id
    "type": "amp:seat", // 坐垫类型，即坐垫实体标识符
    "pos": [0, 8, 0] // 以 1/16 方块边长为单位，以方块底部中央为原点，会随着方块旋转而旋转
  },
  ```

### 食物方块

玩家和方块交互时，可以使其食用属性-1，最后只剩容器时再交互，会使方块消失。目前防不了精准采集。

一、设置方法：
1. 给方块 `components` 加上 `"amp:food": {}`
2. 在文件定义坐位类型和位置： `GlobalCuisine_BP/scripts/data/BlockFood.js`，如：
  ```
  "amp:baozi": { // 方块 id
    "state": "amp:eat_remain", // 属性名
    "effects": [ // 效果列表
      {
        "index": 'all', // 使用时state为这个值时，会施加以下效果，设为 all 代表每次都加
        "health": 1, // 血量 +1
      }
    ]
  }
  ```

二、定义各个使用进度的渲染

1、在行为包的 `description/states` 定义食用状态
```
"states": {
  "amp:eat_remain" : [ 5, 4, 3, 2, 1, 0 ]
}
```

2、在行为包的 `permutations` 使用 `"texture": "amp_void"` 隐藏各个状态需要隐藏的材质：
```
[
  {
    "condition": "query.block_state('amp:eat_remain') == 4",
    "components": {
      "minecraft:material_instances": {
        "*": { "texture": "baozi_amp", "render_method": "alpha_test" },
        "eat_5": { "texture": "amp_void", "render_method": "alpha_test" }
      },
      "minecraft:loot": "loot_tables/farmersdelight/empty.json"
    }
  },
  {
    "condition": "query.block_state('amp:eat_remain') == 3",
    "components": {
      "minecraft:material_instances": {
        "*": { "texture": "baozi_amp", "render_method": "alpha_test" },
        "eat_5": { "texture": "amp_void", "render_method": "alpha_test" },
        "eat_4": { "texture": "amp_void", "render_method": "alpha_test" }
      },
      "minecraft:loot": "loot_tables/farmersdelight/empty.json"
    }
  }
]
```
3、用bb打开模型，UV模式设为逐面UV，右键方块，点击 `Edit Material Instance`，为其设置材质名。材质名对应第二部隐藏的材质。
